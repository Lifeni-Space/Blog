---
import type { MDXInstance } from 'astro'
import Layout from '../../components/Layout.astro'
import type { Article } from '../../types.d'
import { unify } from '../../libs/utils'

export async function getStaticPaths() {
  const output = (articles: MDXInstance<Article>[]) =>
    articles.map(article => ({
      params: { id: article.frontmatter.id },
      props: { article },
    }))

  const articles = (await Astro.glob(
    '../../notebook/文章/*.mdx'
  )) as MDXInstance<Article>[]
  const archives = unify(await Astro.glob('../../notebook/存档/**/*.md'))
  return [...output(articles), ...output(archives)]
}

const { Content } = Astro.props.article
export const prerender = true
---

<Layout>
  <div w="full" flex="~ 1 col items-center justify-start" p="4">
    <article class="prose" w="full" max-w="2xl" text="base">
      <Content />
    </article>
  </div>
</Layout>
