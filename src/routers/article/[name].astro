---
export interface Props {
  article: Article
}

import Layout from 'component:Layout'

import Actions from 'component:article/Actions'
import Indexes from 'component:article/Indexes'

import MediumZoom from 'import:MediumZoom'
import ContentsNavigation from 'import:ContentsNavigation'

export async function getStaticPaths() {
  const files = Astro.fetchContent(
    '../../../contents/articles/*.md'
  ) as Article[]

  return files.map(file => ({
    params: { name: file.name },
    props: { article: file },
  }))
}

const { article } = Astro.props as Props

const highlight = Astro.resolve('../../assets/highlight.css')
const markdown = Astro.resolve('../../markdown.less')
---

<Layout title={article.title} description={article.description}>
  <Fragment slot="head">
    <link rel="stylesheet" href={highlight} />
    <link rel="stylesheet" href={markdown} />
  </Fragment>

  <article set:html={article.astro.html}></article>
  <Actions date={article.date} license={article.license} />
  {article.astro.headers.length !== 1 && (
    <Indexes headers={article.astro.headers} />
  )}

  <MediumZoom client:idle />
  <ContentsNavigation client:media={'(min-width: 72rem)'} />
</Layout>

<style lang="less">
  :global(body) {
    background-color: var(--background) !important;
  }
</style>
