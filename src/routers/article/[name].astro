---
import Layout from 'component:Layout'
import Article from 'component:article/Markdown'
import Meta from 'component:article/Meta'
import Contents from 'component:article/Contents'

export interface Props {
  article: Article
}

export async function getStaticPaths() {
  const files = Astro.fetchContent(
    '../../../contents/articles/*.md'
  ) as Article[]

  return files.map(file => ({
    params: { name: file.name },
    props: { article: file },
  }))
}

const { article } = Astro.props as Props
const highlight = Astro.resolve('../../assets/highlight.css')
---

<Layout title={article.title} description={article.description}>
  <Fragment slot="head">
    <link rel="stylesheet" href={highlight} />
    <link rel="preconnect" href="https://file.lifeni.life" />
  </Fragment>

  <Article html={article.astro.html} />

  <Meta date={article.date} license={article.license} />
  {article.astro.headers.length !== 1 && (
    <Contents headers={article.astro.headers} />
  )}
</Layout>

<style lang="less">
  :global(body) {
    background-color: var(--background) !important;
  }
</style>
