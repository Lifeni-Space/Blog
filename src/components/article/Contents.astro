---
export interface Props {
  headers: Header[]
}

const { headers } = Astro.props as Props
const contents = Astro.resolve('../../libs/follow-contents.ts')
---

<nav data-contents>
  <ul>
    {headers.map(
      header =>
        (header.depth === 2 || header.depth === 3) && (
          <li
            title={header.text}
            data-depth={header.depth}
            data-slug={header.slug}
          >
            <a href={`#${header.slug}`} set:text={header.text} />
          </li>
        )
    )}
  </ul>
</nav>

<script defer type="module" src={contents} hoist></script>

<style lang="less">
  nav[data-contents] {
    position: fixed;
    top: 50%;
    left: 4.075rem;
    width: 18rem;
    transform: translateY(-50%);
    opacity: 0;
    visibility: hidden;

    @media (max-width: 72rem) {
      display: none;
    }

    &[data-show] {
      opacity: 1;
      visibility: visible;
      transition: opacity 0.2s, visibility 0.2s;
    }

    &:hover {
      ul li {
        color: var(--font-secondary);

        a {
          color: var(--font-secondary);
        }

        &[data-active] a {
          color: var(--font-link);
        }
      }
    }

    ul {
      position: relative;
      max-height: calc(100vh - 18rem);
      height: 100%;
      padding: 0.25rem 0;
      overflow-y: auto;
      scrollbar-width: none;
      scroll-behavior: smooth;

      &::-webkit-scrollbar {
        display: none;
      }

      li {
        position: relative;
        width: 100%;
        margin: 0;
        padding: 0.125rem 1.5rem;
        list-style: none;
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
        border-left: solid 0.1rem var(--border-color);
        transition: border 0.2s;

        a {
          width: 100%;
          margin: 0.5rem 0;
          color: var(--font-secondary);
          font-size: 0.925rem;
          transition: color 0.2s;

          &:focus-visible {
            outline-color: var(--font-link);
            outline-width: 0.25rem;
            outline-offset: 0.25rem;
            outline-style: solid;
          }

          &:hover,
          &:focus-visible {
            text-decoration: none;
            color: var(--font-link);
          }
        }

        &[data-active] {
          border-left-color: var(--font-link);

          a {
            color: var(--font-link);
          }
        }

        &[data-depth='1'],
        &[data-depth='2'] {
          font-weight: var(--font-bold);
        }

        hr {
          margin: 0.5rem 0;
          border: none;
          border-top: var(--border);
        }
      }
    }
  }
</style>
