---
import { fileBaseUrl } from '@libs/const'
import dayjs from 'dayjs'
import type { Article } from 'src/types'

export interface Props extends Article {
  type?: '文章' | '专题' | string
}

const {
  type = '文章',
  name,
  subtitle,
  date,
  description,
  id,
  cover,
  draft,
  tags,
} = Astro.props
---

<li class="group flex flex-col items-start gap-2 leading-7">
  {
    cover && (
      <img
        class="w-full rounded-md aspect-video object-cover mb-4 shadow-xl"
        src={`${fileBaseUrl}${cover.image}`}
        alt={cover.caption}
      />
    )
  }

  <h2
    class="max-w-full text-xl font-extrabold flex flex-row gap-4 items-center"
  >
    {
      draft && (
        <span class="text-sm text-dark-900 bg-yellow-400 px-1.5 py-0.5 rounded">
          {'草稿'}
        </span>
      )
    }

    <a
      class="truncate hover:underline underline-offset-4 hover:text-indigo-500 dark:hover:text-indigo-400 transition-colors"
      href={`/${type === '专题' ? 'story' : 'article'}/${id}`}
    >
      {name}
    </a>

    {
      subtitle && (
        <span class="font-medium text-light-600 dark:text-dark-200">
          {subtitle}
        </span>
      )
    }
  </h2>
  <p>{description}</p>
  <span
    class="flex flex-row gap-2 items-center leading-6 text-sm text-light-600 dark:text-dark-200"
  >
    {
      tags ? (
        tags.map(tag => <span>{tag}</span>)
      ) : type === '专题' ? (
        <span>专题</span>
      ) : (
        <span>存档</span>
      )
    }
    <span>|</span>
    <time datetime={dayjs(date.created).format('YYYY-MM-DD')}>
      {dayjs(date.created).format('YYYY 年 MM 月 DD 日')}
    </time>
  </span>
</li>
